(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[932],{83686:()=>{},32383:()=>{},82834:(e,t,r)=>{Promise.resolve().then(r.bind(r,42198))},42198:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var s=r(95155),a=r(75828);let l=(0,a.createServerReference)("40591c1df497acc7e31ceed3e74b922b43ab441fcd",a.callServer,void 0,a.findSourceMapURL,"getTest");var o=r(84801),n=r(12115),i=r(76046),d=r(72790),c=r(12694),u=r(82975);function m(){let[e,t]=n.useState([]),[r,a]=n.useState([]),[m,x]=(0,n.useState)(),g=Number((0,i.usePathname)().replace("/create-test/statistic/","")),[b,p]=n.useState(!1);n.useEffect(()=>{(async()=>{try{let e=await (0,d.q)(),r=await l(g),s=await (0,o.C)();if((null==e?void 0:e.role)==="ADMIN"){let e=s.filter(e=>JSON.parse(e.testsResult).find(e=>e.testName===(null==r?void 0:r.name))),l=e.map(e=>{let t=JSON.parse(e.testsResult).find(e=>e.testName===(null==r?void 0:r.name));return t.passedDate=new Date(Number(t.passedDate)).toLocaleString(),{...e,testsResult:t}});l.sort((e,t)=>t.testsResult.score-e.testsResult.score),a(l),t(l),x(e)}}catch(e){console.error("Error fetching data:",e)}})()},[g]);let f=e.filter(e=>e.testsResult.score>0&&e.testsResult.score<20).length,h=e.filter(e=>e.testsResult.score>=20&&e.testsResult.score<40).length,y=e.filter(e=>e.testsResult.score>=40&&e.testsResult.score<60).length,N=e.filter(e=>e.testsResult.score>=60&&e.testsResult.score<80).length,v=e.filter(e=>e.testsResult.score>=80&&e.testsResult.score<=100).length;return(console.log(f,h,y,N,v),console.log(m&&m.length>0),m)?(0,s.jsxs)("div",{className:"w-12/12 mx-auto mt-3 ",children:[(0,s.jsx)(u.r,{series:[{data:[{id:0,value:f,label:"series A"},{id:1,value:h,label:"series B"},{id:2,value:y,label:"series C"},{id:3,value:N,label:"series C"},{id:4,value:v,label:"series C"}]}],width:500,height:300,className:"mx-auto  -top-9"}),(0,s.jsxs)("div",{className:"flex items-center justify-between rounded-t-xl bg-gray-100 py-3 px-3  pt-4",children:[(0,s.jsxs)("div",{className:"block",children:[(0,s.jsxs)("label",{htmlFor:"from",className:"mx-3  text-lg min-w-0 grow py-1.5 pl-1 pr-3 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6 p-3",children:[" ","Отсортировать в диапазоне времени от:"]}),(0,s.jsxs)("div",{className:"flex items-end",children:[(0,s.jsx)("input",{type:"date",id:"from",className:" w-full p-2 text-gray-900 border border-gray-300 rounded-lg bg-gray-50 text-base focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"}),(0,s.jsxs)("label",{htmlFor:"from",className:"mx-3  min-w-0 grow py-1.5 pl-1 pr-3 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6 p-3",children:[" ","До:"]}),(0,s.jsx)("input",{type:"date",id:"to",className:"mx-3  w-full p-2 text-gray-900 border border-gray-300 rounded-lg bg-gray-50 text-base focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"}),(0,s.jsx)("button",{onClick:()=>{p(!1);let e=document.querySelector("#from"),s=document.querySelector("#to"),l=(null==e?void 0:e.value)||"",o=(null==s?void 0:s.value)||"",n=r.filter(e=>{let t=new Date(l).getTime(),r=new Date(o).getTime(),s=function(e){console.log(e);let[t,r]=e.split(", "),[s,a,l]=t.split(".").map(Number),[o,n,i]=r.split(":").map(Number);return new Date(l,a-1,s,o,n,i).getTime()}(e.testsResult.passedDate);return isNaN(r)?s>=t:isNaN(t)?s<=r:s>=t&&s<=r});0==n.length&&p(!0),a(r),t(n)},type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",children:"Отсортировать"})]})]}),(0,s.jsxs)("div",{className:"block",children:[(0,s.jsxs)("label",{htmlFor:"from",className:"mx-3  text-lg min-w-0 grow py-1.5 pl-1 pr-3 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6 p-3",children:[" ","Отсортировать в диапазоне баллов от:"]}),(0,s.jsxs)("div",{className:"flex items-end",children:[(0,s.jsx)("input",{type:"number",id:"fromScore",className:" w-16 p-2 text-gray-900 border border-gray-300 rounded-lg bg-gray-50 text-base focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"}),(0,s.jsxs)("label",{htmlFor:"fromScore",className:"mx-1 min-w-0 grow py-1.5 pl-1 pr-3 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6 p-3",children:[" ","До:"]}),(0,s.jsx)("input",{type:"number",id:"toScore",className:"mx-3  w-16 p-2 text-gray-900 border border-gray-300 rounded-lg bg-gray-50 text-base focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"}),(0,s.jsx)("button",{onClick:function(){p(!1);let e=document.querySelector("#fromScore"),s=document.querySelector("#toScore"),l=Number(null==e?void 0:e.value)||0,o=Number(null==s?void 0:s.value)||300,n=r.filter(e=>{let t=e.testsResult.score;return isNaN(o)&&o>=0?t>=l:isNaN(l)&&l<=100?t<=o:t>=l&&t<=o});0==n.length&&p(!0),a(r),t(n)},type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",children:"Отсортировать"})]})]}),(0,s.jsx)("button",{onClick:function(){p(!1);let e=document.querySelector("#from"),s=document.querySelector("#to");return e.value="",s.value="",document.querySelector("#search").value="",t(r)},type:"button",className:"mx-3 mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",children:"Очистить фильтры"}),(0,s.jsxs)("div",{className:"flex  items-end ",children:[(0,s.jsxs)("div",{className:"block",children:[(0,s.jsxs)("label",{htmlFor:"from",className:"mx-3  min-w-0 grow py-1.5 pl-1 pr-3 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6 p-3",children:[" ","Выберите категорию начального теста"]}),(0,s.jsxs)("div",{className:"flex justify-center items-center",children:[(0,s.jsxs)("select",{defaultValue:"TRAINING",id:"categorysTest",className:"bg-gray-50 border w-36 border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",children:[(0,s.jsx)("option",{value:"TRAINING",children:"Тренировочный"}),(0,s.jsx)("option",{value:"QUALIFYING",children:"Отборочный"}),(0,s.jsx)("option",{value:"BASIC",children:"Основной"})]}),(0,s.jsx)("button",{onClick:function(){p(!1);let e=document.querySelector("#categorysTest"),s=null==e?void 0:e.value,l=r.filter(e=>e.startTest==s);return 0==l.length&&p(!0),a(r),t(l)},type:"button",className:"mx-3 mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",children:"Найти"})]})]}),(0,s.jsxs)("div",{className:"block",children:[(0,s.jsxs)("label",{htmlFor:"from",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white ",children:[" ","Найти пользователей по имени или организация:"," "]}),(0,s.jsx)("input",{id:"search",type:"text",placeholder:"Имя или название организации",className:"block w-full p-2 text-gray-900 border border-gray-300 rounded-lg bg-gray-50 text-base focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"})]}),(0,s.jsx)("button",{onClick:function(){p(!1);let s=document.querySelector("#search"),l=(null==s?void 0:s.value)||"",o=e.filter(e=>e.firstName.toLowerCase().includes(l.toLowerCase())||e.organisation.toLowerCase().includes(l.toLowerCase()));return 0==o.length&&p(!0),a(r),t(o)},type:"button",className:"mx-3 mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",children:"Найти"})]})]}),b?(0,s.jsx)("div",{className:"relative bg-white container mx-auto flex h-full ring-black/5 max-lg:rounded-t-[2rem] my-6 py-20 shadow ring-1 flex-col overflow-hidden rounded-[calc(theme(borderRadius.lg)+1px)] max-lg:rounded-t-[calc(2rem+1px)]",children:(0,s.jsx)("h4",{className:"mt-2 text-4xl text-center font-medium tracking-tight text-gray-950 max-lg:text-center",children:"Пользователей с таким параметром нету"})}):(0,s.jsxs)("table",{className:"table-auto w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"bg-gray-100",children:[(0,s.jsx)("th",{className:"px-4 py-2",children:"Имя"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Фамилия"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Отчество"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Почта"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Организация"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Специализация"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Уровень начального теста"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Правильных ответов"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Тест пройден"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Когда пройден"})]})}),(0,s.jsx)("tbody",{children:e.map(e=>(0,s.jsxs)("tr",{className:"bg-white border-b cursor-pointer",children:[(0,s.jsx)("td",{className:"px-4 py-2",children:e.firstName}),(0,s.jsx)("td",{className:"px-4 py-2",children:e.lastName}),(0,s.jsx)("td",{className:"px-4 py-2",children:e.surName}),(0,s.jsx)("td",{className:"px-4 py-2",children:e.email}),(0,s.jsx)("td",{className:"px-4 py-2",children:e.organisation}),(0,s.jsx)("td",{className:"px-4 py-2",children:"SCHOOLBOY"==e.role?"Школьники":"STUDENT"==e.role?"Студенты":"Специалисты"}),(0,s.jsx)("td",{className:"px-4 py-2",children:"TRAINING"==e.startTest?"Тренировочный":"QUALIFYING"==e.startTest?"Отборочный":"Основной"}),(0,s.jsx)("td",{children:e.testsResult.score}),(0,s.jsx)("td",{className:"px-4 py-2",children:e.testPassed?"✅":"❌"}),(0,s.jsx)("td",{className:"px-4 py-2",children:e.testsResult.passedDate?e.testsResult.passedDate.toLocaleString():"-"})]},e.id))})]}),(0,s.jsxs)("div",{className:"flex flex-1 justify-center mt-10 px-10 max-lg:pb-12 max-lg:pt-10 sm:px-10 lg:pb-12",children:[" ",(0,s.jsx)(c.A,{response:e})]})]}):void 0}},12694:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var s=r(95155),a=r(12115),l=r(14085),o=r(49688),n=r(51615),i=r(7660);async function d(e){let t=i.Wp.book_new(),r=i.Wp.json_to_sheet(e);i.Wp.book_append_sheet(t,r,"Users");let s=i.M9(t,{type:"buffer",bookType:"xlsx"});return new n.NextResponse(s,{status:200,headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","Content-Disposition":"attachment; filename=users.xlsx"}})}function c(e){let{response:t}=e,[r,n]=(0,a.useState)(!1),i=async()=>{n(!0);try{let e=await d(t),r=await e.blob(),s=window.URL.createObjectURL(r),a=document.createElement("a");a.style.display="none",a.href=s,a.download="users.xlsx",document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(s)}catch(e){console.error("Ошибка экспортирования пользователей:",e),alert("Ошибка экспортирования пользователей. Повторите попытку.")}finally{n(!1)}};return(0,s.jsx)(l.$,{onClick:i,variant:"outline",className:"bg-green-600 text-white hover:bg-green-700 border-none",title:"Экспортировать пользователей",disabled:r,children:r?"Экспорт...":(0,s.jsx)(o.A,{})})}},14085:(e,t,r)=>{"use strict";r.d(t,{$:()=>c});var s=r(95155),a=r(12115),l=r(12317),o=r(31027),n=r(29602),i=r(77594);let d=(0,o.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md active:translate-y-[1px] text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 disabled:bg-gray-500",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-primary text-primary bg-transparent hover:bg-secondary",secondary:"bg-secondary text-primary hover:bg-secondary/50",ghost:"hover:bg-secondary hover:text-secondary-foreground",link:"text-primary underline-offset-4 hover:underline",succes:"bg-green-600 text-destructive-foreground hover:bg-destructive/90"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:r,variant:a,size:o,asChild:c=!1,children:u,disabled:m,loading:x,...g}=e,b=c?l.DX:"button";return(0,s.jsx)(b,{disabled:m||x,className:(0,n.cn)(d({variant:a,size:o,className:r})),ref:t,...g,children:x?(0,s.jsx)(i.A,{className:"w-5 h-5 animate-spin"}):u})});c.displayName="Button"},29602:(e,t,r)=>{"use strict";r.d(t,{cn:()=>l});var s=r(43463),a=r(69795);function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}},84801:(e,t,r)=>{"use strict";r.d(t,{C:()=>a});var s=r(75828);let a=(0,s.createServerReference)("00d9909268c6282437558928b9eb7fe52fa09feb7d",s.callServer,void 0,s.findSourceMapURL,"getAllUsers")},72790:(e,t,r)=>{"use strict";r.d(t,{q:()=>a});var s=r(75828);let a=(0,s.createServerReference)("00da94c5e624ddc6ef000e2b169d099c73b17ffb28",s.callServer,void 0,s.findSourceMapURL,"getUserSession")}},e=>{var t=t=>e(e.s=t);e.O(0,[524,525,402,86,716,441,517,358],()=>t(82834)),_N_E=e.O()}]);